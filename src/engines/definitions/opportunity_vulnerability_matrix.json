{
  "engine_key": "opportunity_vulnerability_matrix",
  "engine_name": "Opportunity & Vulnerability Matrix",
  "description": "Systematically identifies vulnerabilities that could be exploited and opportunities that could be leveraged. Pairs threats with weaknesses, assesses exploitation likelihood and impact, and prioritizes for mitigation and action. Essential for defensive analysis and strategic planning.",
  "version": 1,
  "category": "power",
  "kind": "synthesis",
  "reasoning_domain": "power",
  "researcher_question": "What vulnerabilities exist and what opportunities are available?",
  "extraction_prompt": "\nYou are conducting a comprehensive OPPORTUNITY & VULNERABILITY ASSESSMENT \u2014\nidentifying weaknesses that could be exploited and opportunities that could be leveraged.\n\n## THE O&V FRAMEWORK\n\nEvery organization, system, and position has:\n- VULNERABILITIES: Weaknesses that adversaries might exploit\n- OPPORTUNITIES: Gaps that could be leveraged for advantage\n\nSeeing these before adversaries do enables defense. Seeing opportunities enables initiative.\n\n\n## YOUR TASK\n\n### STEP 1: SCOPE THE ASSESSMENT\n\nWhat entity is being assessed?\n- Organization, system, process, strategy, position?\n- What aspects are we examining?\n- What's the relevant context?\n\n### STEP 2: MAP VULNERABILITIES\n\nSystematically identify weaknesses across domains:\n\n**TECHNICAL:** System weaknesses, security gaps, technological limitations\n**HUMAN:** People vulnerabilities \u2014 social engineering, insider risk, skill gaps\n**ORGANIZATIONAL:** Structural weaknesses, process failures, coordination gaps\n**INFORMATIONAL:** Knowledge gaps, information security, intelligence vulnerabilities\n**PHYSICAL:** Location, infrastructure, access control weaknesses\n**PROCEDURAL:** Policy gaps, compliance failures, process vulnerabilities\n**REPUTATIONAL:** Image vulnerabilities, trust dependencies, perception risks\n\nFor each vulnerability:\n- What exactly is the weakness?\n- Why does it exist (root cause)?\n- How exposed is it currently?\n- How easy would it be to exploit?\n- How hard would exploitation be to detect?\n- What's the impact if exploited?\n- What are signs of probing/exploitation?\n- What mitigation options exist?\n\n### STEP 3: IDENTIFY OPPORTUNITIES\n\nMap opportunities for:\n- **OURSELVES:** What advantages could we seize?\n- **ADVERSARIES:** What might they exploit?\n- **THIRD PARTIES:** What might neutral parties do?\n\nFor each opportunity:\n- What creates this opportunity?\n- How long is the window open?\n- What's needed to exploit it?\n- What's the potential value?\n- What are the risks of action/inaction?\n- Who else might be competing for it?\n\n### STEP 4: MAP THREAT ACTORS\n\nWho might exploit vulnerabilities?\n- What's their intent?\n- What's their capability?\n- What resources do they have?\n- What's their track record?\n- Are they currently active?\n\n### STEP 5: PAIR THREATS WITH VULNERABILITIES\n\nFor significant pairings:\n- Which actor might exploit which vulnerability?\n- How would they do it?\n- How likely is this?\n- What would indicate they're trying?\n- How quickly could they act?\n\n### STEP 6: BUILD RISK MATRIX\n\nFor each vulnerability:\n- Likelihood of exploitation (1-5)\n- Impact if exploited (1-5)\n- Risk score (likelihood \u00d7 impact)\n- Priority category\n\n### STEP 7: GAP ANALYSIS\n\nWhat's missing?\n- **Defensive gaps:** Missing protections\n- **Offensive gaps:** Missing capability to seize opportunities\n- **Intelligence gaps:** What we don't know that affects assessment\n\n### STEP 8: SCENARIO ANALYSIS\n\nFor top vulnerabilities and opportunities:\n- What happens if exploited/seized?\n- What's the sequence of events?\n- What's the end state?\n- What are our response options?\n\n### STEP 9: ACTION RECOMMENDATIONS\n\nPrioritized actions:\n- **Immediate:** Address critical vulnerabilities now\n- **Short-term:** Reduce risk, position for opportunities\n- **Long-term:** Strategic improvements\n- **Avoid:** What NOT to do\n\n## OUTPUT GUIDANCE\n\nFocus on ACTIONABLE findings. Generic vulnerabilities like \"could be hacked\" aren't useful.\nSpecific vulnerabilities like \"legacy authentication system lacks MFA, exploitable via\ncredential stuffing attack\" enable response.\n\nPrioritize by risk score. Not all vulnerabilities are equal.\n\nInclude opportunities, not just vulnerabilities. Defense is necessary but not sufficient.\n",
  "curation_prompt": "\nYou are synthesizing vulnerability and opportunity assessments from multiple sources\nto create a comprehensive risk and opportunity picture.\n\n\n## SYNTHESIS TASKS\n\n### 1. CONSOLIDATE VULNERABILITIES\n\n- Merge equivalent vulnerabilities from different sources\n- Note where multiple sources identify the same weakness (higher confidence)\n- Identify vulnerabilities unique to single sources (investigate further)\n- Reconcile different severity assessments\n\n### 2. INTEGRATE OPPORTUNITIES\n\n- Consolidate opportunity findings\n- Note competitive dynamics for the same opportunities\n- Assess cumulative opportunity value\n\n### 3. UNIFIED THREAT ACTOR PICTURE\n\n- Merge threat actor profiles across sources\n- Consolidate capability and intent assessments\n- Create comprehensive threat-vulnerability pairings\n\n### 4. COMPREHENSIVE RISK MATRIX\n\n- Build unified risk matrix across all vulnerabilities\n- Standardize scoring methodology\n- Create clear prioritization\n\n### 5. INTEGRATED GAP ANALYSIS\n\n- Consolidate all gap findings\n- Identify systematic gaps (appearing across sources)\n- Prioritize collection requirements\n\n### 6. SYNTHESIZED RECOMMENDATIONS\n\n- Consolidate action recommendations\n- Resolve conflicting recommendations\n- Create prioritized action plan\n\n### 7. OVERALL EXPOSURE ASSESSMENT\n\n- What's the aggregate risk picture?\n- What are the crown jewels at risk?\n- What opportunities are we missing?\n- What's the confidence in the assessment?\n\n## OUTPUT GUIDANCE\n\nCreate an integrated O&V assessment that enables:\n1. Understanding of risk exposure\n2. Prioritized mitigation actions\n3. Opportunity identification and seizure\n4. Resource allocation decisions\n",
  "concretization_prompt": "\nTransform the O&V analysis into an actionable assessment:\n\n1. **EXECUTIVE SUMMARY**\n   ```\n   OVERALL EXPOSURE: [CRITICAL / HIGH / ELEVATED / MODERATE / LOW]\n   Vulnerabilities: [Total] | Critical: [X] | High: [Y]\n   Opportunities: [Total] | High-value: [Z]\n   Most Urgent Issue: [Brief description]\n   ```\n\n2. **CRITICAL VULNERABILITIES** (Address Immediately)\n   ```\n   | ID | Vulnerability | Domain | Risk Score | Threat Actor | Action |\n   |----|--------------|--------|------------|--------------|--------|\n   | V1 | [Description]| Tech   | 25/25      | [Actor]      | [Fix]  |\n   ```\n\n3. **HIGH-VALUE OPPORTUNITIES**\n   ```\n   | ID | Opportunity | Window | Value | Prerequisites | Competition |\n   |----|-------------|--------|-------|---------------|-------------|\n   | O1 | [Desc]      | Short  | High  | [Req]         | [Who else]  |\n   ```\n\n4. **THREAT ACTOR SUMMARY**\n   ```\n   | Actor | Intent | Capability | Target Vulnerabilities | Activity |\n   |-------|--------|------------|------------------------|----------|\n   ```\n\n5. **RISK MATRIX VISUALIZATION**\n   ```\n              IMPACT\n              Low  Med  High Severe Critical\n   LIKELIHOOD \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   Almost     \u2502    \u2502    \u2502 V3 \u2502 V1  \u2502       \u2502\n   Certain    \u2502    \u2502    \u2502    \u2502     \u2502       \u2502\n   Highly     \u2502    \u2502 V4 \u2502    \u2502     \u2502       \u2502\n   Likely     \u2502    \u2502    \u2502    \u2502     \u2502       \u2502\n   Likely     \u2502    \u2502    \u2502 V2 \u2502     \u2502       \u2502\n   Possible   \u2502 V5 \u2502    \u2502    \u2502     \u2502       \u2502\n   Unlikely   \u2502    \u2502    \u2502    \u2502     \u2502       \u2502\n              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n   ```\n\n6. **PRIORITY ACTIONS**\n\n   **IMMEDIATE (This Week):**\n   - [ ] [Action 1] \u2014 Addresses: [V1] \u2014 Owner: [Who]\n   - [ ] [Action 2] \u2014 ...\n\n   **SHORT-TERM (This Month):**\n   - [ ] [Action 3] \u2014 Addresses: [V2, V3] \u2014 Resources: [What]\n\n   **LONG-TERM (This Quarter):**\n   - [ ] [Strategic improvement]\n\n7. **THINGS TO AVOID**\n   - Do NOT [action] \u2014 Risk: [consequence]\n   - Do NOT [action] \u2014 Risk: [consequence]\n\n8. **KEY SCENARIOS**\n   - If [V1] is exploited: [Sequence] \u2192 [End state] \u2192 Our response: [Options]\n\n9. **INTELLIGENCE GAPS**\n   - We don't know: [X] \u2014 Affects: [Which assessments] \u2014 Collection priority: [H/M/L]\n\n10. **BOTTOM LINE**\n    [One paragraph: What's our exposure? What must we do? What opportunities exist?]\n\nMake it actionable for decision-makers and security teams.\n",
  "canonical_schema": {
    "entity_assessed": {
      "entity_name": "string - who/what is being assessed",
      "entity_type": "organization | system | process | position | strategy",
      "assessment_scope": "string - what aspects are being examined",
      "context": "string - relevant situational context"
    },
    "vulnerabilities": [
      {
        "vulnerability_id": "string - V1, V2, etc.",
        "domain": "technical | human | organizational | informational | physical | procedural | reputational",
        "description": "string - the weakness",
        "root_cause": "string - why this vulnerability exists",
        "indicators": [
          "string - signs this vulnerability is being probed"
        ],
        "current_exposure": "exposed | partially_exposed | latent | mitigated",
        "ease_of_exploitation": "trivial | easy | moderate | difficult | very_difficult",
        "detection_difficulty": "easily_detected | detectable | difficult_to_detect | likely_undetected",
        "impact_if_exploited": {
          "severity": "catastrophic | severe | significant | moderate | minor",
          "impact_description": "string - what happens",
          "affected_areas": [
            "string"
          ],
          "recovery_difficulty": "easy | moderate | difficult | very_difficult | impossible"
        },
        "currently_exploited": "boolean",
        "evidence_of_probing": "boolean",
        "mitigation_options": [
          {
            "mitigation": "string",
            "effectiveness": "high | medium | low",
            "cost_effort": "high | medium | low",
            "timeline": "immediate | short_term | long_term"
          }
        ]
      }
    ],
    "opportunities": [
      {
        "opportunity_id": "string - O1, O2, etc.",
        "opportunity_for": "self | adversary | third_party",
        "domain": "strategic | tactical | informational | economic | political | reputational",
        "description": "string - the opportunity",
        "why_available": "string - what creates this opportunity",
        "window": "permanent | long_term | medium_term | short_term | closing",
        "prerequisites": [
          "string - what's needed to exploit"
        ],
        "potential_value": "transformative | high | medium | low",
        "risks_of_action": "string - downsides of attempting",
        "risks_of_inaction": "string - cost of not acting",
        "competing_for_opportunity": [
          "string - who else might act"
        ]
      }
    ],
    "threat_actors": [
      {
        "actor_id": "string",
        "actor_name": "string",
        "actor_type": "state | non_state | criminal | competitor | insider | other",
        "intent": "hostile | opportunistic | unknown | benign",
        "capability_level": "sophisticated | capable | developing | limited",
        "resources": "extensive | significant | moderate | limited",
        "track_record": "string - history of exploitation",
        "current_activity": "active | dormant | unknown"
      }
    ],
    "threat_vulnerability_pairing": [
      {
        "pairing_id": "string",
        "threat_actor_id": "string",
        "vulnerability_id": "string",
        "exploitation_method": "string - how they might exploit",
        "likelihood": "almost_certain | highly_likely | likely | possible | unlikely",
        "rationale": "string - why this pairing is concerning",
        "indicators_of_attempt": [
          "string - warning signs"
        ],
        "time_to_exploit": "immediate | days | weeks | months"
      }
    ],
    "opportunity_actor_pairing": [
      {
        "pairing_id": "string",
        "actor_id": "string - who could seize opportunity",
        "opportunity_id": "string",
        "action_required": "string - what they would do",
        "likelihood_of_action": "almost_certain | highly_likely | likely | possible | unlikely",
        "our_response_if_taken": "string - how to respond"
      }
    ],
    "risk_matrix": [
      {
        "item_id": "string - vulnerability or opportunity ID",
        "item_type": "vulnerability | opportunity_for_adversary",
        "likelihood_score": "number (1-5)",
        "impact_score": "number (1-5)",
        "risk_score": "number (1-25) - likelihood \u00d7 impact",
        "risk_category": "CRITICAL | HIGH | MEDIUM | LOW",
        "priority_action": "string - what to do"
      }
    ],
    "gap_analysis": {
      "defensive_gaps": [
        {
          "gap": "string - missing protection",
          "vulnerabilities_affected": [
            "string - vulnerability_ids"
          ],
          "priority": "critical | high | medium | low"
        }
      ],
      "offensive_gaps": [
        {
          "gap": "string - missing capability to seize opportunity",
          "opportunities_affected": [
            "string - opportunity_ids"
          ],
          "development_needed": "string"
        }
      ],
      "intelligence_gaps": [
        {
          "gap": "string - what we don't know",
          "affects_assessment_of": [
            "string - V/O IDs"
          ],
          "collection_priority": "high | medium | low"
        }
      ]
    },
    "action_recommendations": {
      "immediate_actions": [
        {
          "action": "string",
          "addresses": [
            "string - V/O IDs"
          ],
          "owner": "string - who should act",
          "success_criteria": "string"
        }
      ],
      "short_term_actions": [
        {
          "action": "string",
          "addresses": [
            "string - V/O IDs"
          ],
          "timeline": "string",
          "resources_required": "string"
        }
      ],
      "long_term_improvements": [
        {
          "improvement": "string",
          "strategic_value": "string",
          "investment_required": "high | medium | low"
        }
      ],
      "things_to_avoid": [
        {
          "action": "string - what not to do",
          "why": "string - consequence"
        }
      ]
    },
    "scenario_analysis": [
      {
        "scenario_id": "string",
        "scenario": "string - what if this vulnerability is exploited / opportunity seized",
        "trigger": "string",
        "sequence": [
          "string - what happens"
        ],
        "end_state": "string",
        "our_position_after": "string",
        "response_options": [
          "string"
        ]
      }
    ],
    "meta": {
      "total_vulnerabilities": "number",
      "critical_vulnerabilities": "number",
      "total_opportunities": "number",
      "high_value_opportunities": "number",
      "most_dangerous_vulnerability": "string - vulnerability_id",
      "best_opportunity": "string - opportunity_id",
      "overall_exposure_level": "CRITICAL | HIGH | ELEVATED | MODERATE | LOW",
      "confidence_in_assessment": "high | medium | low"
    }
  },
  "extraction_focus": [
    "vulnerability_identification",
    "opportunity_identification",
    "threat_actor_mapping",
    "exploitation_assessment",
    "prioritization"
  ],
  "primary_output_modes": [
    "structured_text_report",
    "table"
  ],
  "paradigm_keys": [],
  "source_file": "analyzer/src/engines/opportunity_vulnerability_matrix.py"
}